---
phase: 27-game-loop-ai
plan: 01
type: execute
wave: 1
depends_on: ["24-01", "24-02", "25-01", "25-02", "26-01"]
files_modified:
  - autoloads/auto_bot.gd
autonomous: true

must_haves:
  truths:
    - "Bot has a game state machine: FARM → SHOP → TRAVERSE → CLEAR → BOSS → VICTORY"
    - "Bot farms enemies in neighborhood to level up and earn coins"
    - "Bot visits shop when transitioning between FARM and TRAVERSE"
    - "Bot navigates between zones in progression order"
    - "Bot clears all enemies in each zone before moving on"
    - "Bot enters boss arena and fights the boss"
    - "Bot detects boss defeat and enters VICTORY state"
  artifacts:
    - path: "autoloads/auto_bot.gd"
      provides: "Full game loop AI state machine"
      contains: "GameLoopState, _update_game_loop, _game_loop_farm"
  key_links:
    - from: "autoloads/auto_bot.gd _update_game_loop()"
      to: "wants_zone_transition / target_exit_zone_id"
      via: "Game loop sets zone transition flags for Phase 26 navigation"
---

<objective>
Add a high-level game loop state machine that drives the AutoBot through the entire game: farm enemies, shop for supplies, traverse zones, clear enemies, and defeat the boss.

Purpose: Transforms the bot from a combat-only fighter into a game-completing AI.
Output: auto_bot.gd with GameLoopState enum and state machine in _physics_process.
</objective>

<tasks>
<task type="auto">
  <name>Task 1: Game Loop State Machine</name>
  <files>autoloads/auto_bot.gd</files>
  <action>Implemented inline — see 27-01-SUMMARY.md</action>
  <verify>All GameLoopState values referenced in match statement. _update_game_loop called in _physics_process.</verify>
  <done>Full FARM→SHOP→TRAVERSE→CLEAR→BOSS→VICTORY state machine operational.</done>
</task>
</tasks>

<success_criteria>
- Bot progresses through all 6 game loop states
- Zone progression: Neighborhood → Backyard → Sewers → Boss Arena
- Level gates: Sewers requires level 3, Boss requires level 5
- Kill tracking per zone for farm completion
- Victory detection on boss defeat
</success_criteria>
